---
title: "Dados de uma empresa"
author: "Eduardo Vinnícius (evdcn) e Brenda ... ()"
runtime: shiny
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill

---

```{r setup, include=FALSE}

library(flexdashboard)
library(dplyr)
library(ggplot2)
library(readr)
library(DT)
library(tidyverse)
library(plotly)

Dados_empresa <- read.csv("Month_Value_1.csv")

mode <- function(codes){
  which.max(tabulate(codes))
}


```

# Barra lateral {.sidebar}

```{r}

selectInput("tempo", label = "Ano",
  choices = c("2015", "2016", "2017", "2018", "2019", "2020", "Todos"), selected = "2018")

```

# Receita {data-navmenu="Visualizações"}

## Receita {.tabset}

### Gráfico de linhas

```{r}
Dados_empresa %>%
  #Quando eu faço por mês, não funciona a linha - provavelmente porque o ano não está filtrado
  group_by(Mês) %>%
  #Teria que dar filter por ano
    summarise(Receita_media = mean(Receita, na.rm = TRUE)) %>% 
    ggplot() +
    geom_line(aes(x = Mês, y = Receita_media)) 
    #geom_point(aes(x = Mês, y = Receita_media))
```

### Histograma

```{r}
Dados_empresa %>%
  #Não sei como dar o input ao filter
  #dados <- input$tempo
  #filter(dados == Ano) %>%
  ggplot() +
  geom_histogram(
    aes(x = Receita), 
    binwidth = 12,
    color = "red"
  )
```


### Boxplot

```{r}
Dados_empresa %>% 
  group_by(Mês) %>% 
  ggplot() +
  geom_boxplot(aes(x = Mês, y = Receita))

```

### Tabela

```{r}
Dados_empresa %>%
  group_by(Ano) %>%
  summarise(Média = mean(Receita),
            Mediana = median(Receita),
            Moda= mode(Receita),
            Desvio_Padrão = sd(Receita),
            Mínimo = min(Receita),
            Máximo = max(Receita)) %>%
  knitr::kable()

```


# Vendas {data-navmenu="Visualizações"} 

## Vendas {.tabset}

### Histrograma 

```{r}
renderPlotly({
  grafico = ggplot(
  
  data = Dados_empresa %>% 
         filter(str_detect(tempo, ifelse(input$tempo == 'Todos',"",input$tempo))),
  
        aes(x=Mês, y=Número_de_vendas, color = tempo)) + 
        geom_point()
  
ggplotly(grafico)
})
```


### Boxplot

### Tabela

```{r}

Dados_empresa %>%
  group_by(Ano) %>%
  summarise(Média = mean(Número_de_vendas),
            Mediana = median(Número_de_vendas),
            Moda= mode(Número_de_vendas),
            Desvio_Padrão = sd(Número_de_vendas),
            Mínimo = min(Número_de_vendas),
            Máximo = max(Número_de_vendas)) %>%
  knitr::kable()

```
# Custo Médio {data-navmenu="Visualizações"}

## Custo Médio  {.tabset}

### Boxplot

### Tabela

```{r}
Dados_empresa %>%
  group_by(Ano) %>%
  summarise(Média = mean(Custo_médio),
            Mediana = median(Custo_médio),
            Moda= mode(Custo_médio),
            Desvio_Padrão = sd(Custo_médio),
            Mínimo = min(Custo_médio),
            Máximo = max(Custo_médio)) %>%
  knitr::kable()
```
# Gasto com Funcionários {data-navmenu="Visualizações"}

## Gasto com Funcionários {.tabset}

### Boxplot

### Tabela

```{r}
Dados_empresa %>%
  group_by(Ano) %>%
  summarise(Média = mean(Folha_de_pagamento_média_anual),
            Mediana = median(Folha_de_pagamento_média_anual),
            Moda= mode(Folha_de_pagamento_média_anual),
            Desvio_Padrão = sd(Folha_de_pagamento_média_anual),
            Mínimo = min(Folha_de_pagamento_média_anual),
            Máximo = max(Folha_de_pagamento_média_anual)) %>%
  knitr::kable()
```

# Comparações {data-icon="fa-table"}

## Barra Lateral {.sidebar}

```{r}

```

## Column {data-width= 1080} {.tabset}

### Tabela

```{r}

renderTable({
  head(Dados_empresa, n = input$rows)
})

```

### Gráfico de barras

```{r}

```

### Gráfico de linhas

```{r}

```

### Scatterplot

```{r}

```

